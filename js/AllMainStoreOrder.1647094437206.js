(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["AllMainStoreOrder"],{"2b36":function(t,e,o){},"2ca6":function(t,e,o){"use strict";o("fdec")},6815:function(t,e,o){"use strict";o("2b36")},"995a":function(t){t.exports=JSON.parse('{"Status":200,"ErrorMessage":null,"Data":[{"CustomerID":"11B0607000","CustomerShtName":"厚德藥局","CustomerFullName":"佳和藥局","Owner":"","Contact":"林某某醫師","TEL_NO":"02-2971-7277","FAX_NO":"02-2982-2728","Email":"","TaxID":"25600277","DeptID":"23100","DeptName":"人藥局通路","SalespersonID":null,"SalespersonName":"H_北A2區","Channel":"241","ChannelName":"新北三重區","ZipCode":"241","Address":"新北市三重區大智街175號/厚德藥局","InvoiceZipCode":"241","InvoiceAddress":"新北市三重區大智街175號/厚德藥局","ShippingZipCode":"241","ShippingAddress":"新北市三重區大智街175號/厚德藥局","PaymentTermsCode":"015-00","PaymentTermsDesc":"統一客樂的代收","ClosingDate":"","BankCode":"","BankName":"","BankAccount":"","HQCode":"11B0607000","HQPayment":"N","BranchCount":0,"TypeCode":"02","TypeName":"藥局","HQInvoice":"N","CType":"2","CTypeName":"法人","UType":"2","UTypeName":"B2B存證","ChangeNotTaxiId":false,"CustomerDesc":"●與分店佳和藥台北11B0808000\\r\\n，一起算後贈\\r\\n\\r\\n●2017/12/5改佳和藥局統編\\r\\n厚德藥局/30380766\\r\\n\\r\\n●2017/3/2新增統編","AddCenterCode":"","IsVIP":false,"Headquarters":null},{"CustomerID":"11B0607001","CustomerShtName":"晨星藥局","CustomerFullName":"厚德藥局","Owner":"","Contact":"林某某醫師","TEL_NO":"02-8985-6533","FAX_NO":"","Email":"","TaxID":"30380766","DeptID":"23100","DeptName":"人藥局通路","SalespersonID":null,"SalespersonName":"H_北A2區","Channel":"241","ChannelName":"新北三重區","ZipCode":"241","Address":"新北市三重區五華街123號/晨星藥局","InvoiceZipCode":"241","InvoiceAddress":"新北市三重區五華街123號/晨星藥局","ShippingZipCode":"241","ShippingAddress":"新北市三重區五華街123號/晨星藥局","PaymentTermsCode":"015-00","PaymentTermsDesc":"統一客樂的代收","ClosingDate":"","BankCode":"","BankName":"","BankAccount":"","HQCode":"11B0607000","HQPayment":"N","BranchCount":0,"TypeCode":"02","TypeName":"藥局","HQInvoice":"N","CType":"2","CTypeName":"法人","UType":"2","UTypeName":"B2B存證","ChangeNotTaxiId":false,"CustomerDesc":"2017/8/28新增\\r\\n為厚德藥局分店","AddCenterCode":"","IsVIP":false,"Headquarters":null}]}')},aca8:function(t,e,o){},d0e0:function(t,e,o){"use strict";o.r(e);var r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("article",[t._m(0),t._l(t.orderRows,(function(e){return o("section",{key:e.parentGuid},[o("OrderTemplate",{key:t.keyData,attrs:{orderProduct:e},on:{exportAllQuantity:t.getAllOrderTemplateQuantity,removeTemplate:t.removeTemplate,addNewDetailRows:t.addNewDetailRows,removeRowsDetail:t.removeRowsDetail}})],1)})),0===t.orderRows.length?o("section",{staticClass:"pl-2 mb-2"},[t._v(" 暫無訂購品項... ")]):t._e(),t._m(1),t._l(t.prRows,(function(e){return o("section",{key:e.parentGuid},[o("PRTemplate",{key:t.keyData,attrs:{PRProduct:e},on:{removeTemplate:t.removeTemplate,exportAllQuantity:t.getAllPRTemplateQuantity,addNewDetailRows:t.addNewDetailRows,removeRowsDetail:t.removeRowsDetail}})],1)})),0===t.prRows.length?o("section",{staticClass:"pl-2 mb-2"},[t._v(" 暫無公關品項... ")]):t._e(),o("div",{staticClass:"result-wrap"},[o("div",{staticClass:"item"},[t._v(" 訂購總量 "),o("span",[t._v(t._s(t.totalOrderQuantity))])]),o("div",{staticClass:"item"},[t._v(" 公關總量 "),o("span",[t._v(t._s(t.totalPRQuantity))])]),o("div",{staticClass:"amount",staticStyle:{"background-color":"#fff"}},[t._v(" 總品項 "),o("span",[t._v(t._s(t.totalOrderQuantity+t.totalPRQuantity))])]),o("button",{staticClass:"btn btn_info",attrs:{type:"button"},on:{click:t.openCheck}},[t._v(" 確認訂單 ")])]),o("Order",{on:{sendData:t.sendData}}),o("CheckOrder",{key:t.keyData,attrs:{IsMainStore:!0,DeliveryDate:t.allDeliveryDate,DeliveryTime:t.allDeliveryTime,Charge:t.allCharge,Freight:t.allFreight}})],2)])},a=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"table-title"},[o("span",[t._v("訂購品項")]),o("button",{staticClass:"btn btn_primary",attrs:{type:"button","data-toggle":"modal","data-target":"#placeordermodal"}},[t._v(" 新增品項 ")])])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"table-title"},[o("span",[t._v("公關品項")]),o("button",{staticClass:"btn btn_primary",attrs:{type:"button","data-toggle":"modal","data-target":"#placeordermodal"}},[t._v(" 新增品項 ")])])}],n=o("5530"),i=(o("159b"),o("a434"),o("99af"),o("a9e3"),function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"office-block"},[o("div",{staticClass:"store-title"},[o("span",[t._v(" "+t._s(t.product.ItemNo)+"-"+t._s(t.product.ItemName)+" (庫存量:"+t._s(t.product.InvQty)+") ")])]),o("span",{staticClass:"templateDel",on:{click:function(e){return t.delProduct(t.product.OrderTemplateId)}}},[o("i",{staticClass:"far fa-trash-alt"})]),t._m(0),t._l(t.detailRows,(function(e,r){return o("div",{key:r,staticClass:"store-list"},[o("div",{staticClass:"store bg-white"},[o("span",{directives:[{name:"show",rawName:"v-show",value:e.IsPending,expression:"orderItem.IsPending"}],staticClass:"pendingOrder"},[t._v("掛單")]),o("span",{staticClass:"pl-3 text-center font-weight-bold"},[t._v(t._s(r+1)+".")]),o("VSelect",{staticClass:"col-6",attrs:{getOptionLabel:function(t){return t.customName},placeholder:"請選擇",valueFormat:"object",options:t.filterStore,disabled:e.IsPending&&e.store&&t.product.InvQty>0},on:{input:function(o){return t.changeStore(e)}},model:{value:e.store,callback:function(o){t.$set(e,"store",o)},expression:"orderItem.store"}},[o("span",{attrs:{slot:"no-options"},slot:"no-options"},[t._v("暫無資料")])]),o("input",{directives:[{name:"model",rawName:"v-model.number",value:e.orderQuantity,expression:"orderItem.orderQuantity",modifiers:{number:!0}}],staticClass:"amount col-2",attrs:{type:"number",placeholder:"請輸入數量",disabled:!e.store||e.IsPending&&t.product.InvQty>0},domProps:{value:e.orderQuantity},on:{keyup:function(o){return t.checkQuantity(e,"訂購")},change:function(o){return t.checkQuantity(e,"訂購")},input:function(o){o.target.composing||t.$set(e,"orderQuantity",t._n(o.target.value))},blur:function(e){return t.$forceUpdate()}}}),o("input",{directives:[{name:"model",rawName:"v-model.number",value:e.warehousesNum,expression:"orderItem.warehousesNum",modifiers:{number:!0}}],staticClass:"amount col-2",attrs:{type:"number",placeholder:"請輸入數量",disabled:!e.store||e.IsPending},domProps:{value:e.warehousesNum},on:{keyup:function(o){return t.checkQuantity(e,"寄倉")},change:function(o){return t.checkQuantity(e,"寄倉")},input:function(o){o.target.composing||t.$set(e,"warehousesNum",t._n(o.target.value))},blur:function(e){return t.$forceUpdate()}}}),o("div",{staticClass:"col-2 px-0"},[o("button",{staticClass:"btn btn_primary",attrs:{type:"button"},on:{click:function(e){return t.addNewItem(t.detailRows.length+1)}}},[t._v(" 新增 ")]),o("button",{staticClass:"btn btn_danger",attrs:{type:"button"},on:{click:function(o){return t.delItem(r,e)}}},[t._v(" 移除 ")])])],1)])})),o("InventoryShortageModal",{ref:t.orderGuid,attrs:{Guid:t.orderGuid,Store:t.orderStore,InvQty:t.product.InvQty,inputType:t.inputType,screenTotal:t.nowTotal,currentValue:t.currentValue,totalMinusScreen:t.totalMinusNow},on:{confirmQuantity:t.InventoryShortItem,returnMax:t.returnMax}})],2)}),s=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"store-list"},[o("div",{staticClass:"row"},[o("span",{staticClass:"px-0 col-6 pl-5 text-muted small mr-3"},[t._v(" * 請先選擇分店再輸入數量 ")]),o("span",{staticClass:"pl-0 ml-0 col-2 text-center font-weight-bold"},[t._v(" 訂購數量 ")]),o("span",{staticClass:"pl-0 col-2 text-center font-weight-bold"},[t._v("寄倉數量")]),o("span",{staticClass:"col-2"})])])}],u=o("2909"),l=(o("d81d"),o("4de4"),o("c3b6")),d=o("6946"),c=o("6e77"),m=o("995a"),p={name:"OrderTemplate",mixins:[d["a"],c["a"]],props:{orderProduct:Object},data:function(){return{detailRows:[],allBranch:[],inputType:"訂購",product:{},orderGuid:"",orderStore:{},exceptProduct:{},nowTotal:0,totalMinusNow:0,currentValue:0}},methods:{addNewItem:function(){var t=this;t.detailRows.push({Guid:t.Guid(),IsPending:!1,store:null,orderQuantity:1,warehousesNum:0,IsPartialDelivery:!1,PartialDeliveryQuantity:0,productData:[Object(n["a"])({IsPending:!1,StoreGuid:null},t.exceptProduct)]}),t.$emit("addNewDetailRows",t.detailRows,"Order",t.product.OrderTemplateId)},delItem:function(t,e){var o=this;o.detailRows.some((function(e,r){if(t===r)return o.$store.commit("DELBRANCHSTORE",e),!0})),"OrderSearch"===localStorage.getItem("routerFrom")&&o.$emit("removeRowsDetail",e),o.detailRows.splice(t,1),o.$nextTick((function(){0===o.detailRows.length&&setTimeout((function(){o.$emit("removeTemplate",o.product.OrderTemplateId,"orderRows",!0)}),50)}))},delProduct:function(t){var e=this;e.detailRows.forEach((function(t){e.$store.commit("DELBRANCHSTORE",t)})),e.$nextTick((function(){setTimeout((function(){e.$emit("removeTemplate",t,"orderRows",!0)}),50)}))},checkQuantity:function(t,e){var o=this;if("寄倉"===e&&t.warehousesNum>t.orderQuantity)return o.$notify({title:"提示",message:"寄倉數量不得大於訂購數量",type:"warning",duration:5e3}),void o.$nextTick((function(){t.warehousesNum=t.orderQuantity}));o.currentValue=Number(t.orderQuantity),t.productData=[],t.productData[0]=Object(n["a"])({IsPartialDelivery:!1,PartialDeliveryQuantity:0,IsPending:t.IsPending,orderQuantity:t.orderQuantity,warehousesNum:t.warehousesNum,StoreGuid:t.Guid},o.exceptProduct),o.$store.commit("CHANGEBRANCHQUANTITY",t),o.nowTotal=0,o.detailRows.forEach((function(t){t.IsPending||(o.nowTotal+=Number(t.orderQuantity))})),o.totalMinusNow=o.product.InvQty-o.nowTotal,o.nowTotal>o.product.InvQty&&o.totalMinusNow<0&&(o.inputType=e,o.orderGuid=t.Guid,o.orderStore=t.store,o.$nextTick((function(){var e=o.$refs[t.Guid].$el;$(e).modal("show")})))},changeStore:function(t){var e,o,r,a,i,s,l,d=this,c={};t.productData=[],t.productData.push(Object(n["a"])({IsPartialDelivery:!1,PartialDeliveryQuantity:0,IsPending:t.IsPending,orderQuantity:t.orderQuantity,warehousesNum:t.warehousesNum,StoreGuid:t.Guid},d.exceptProduct)),c={TaxId:(null===t||void 0===t||null===(e=t.store)||void 0===e?void 0:e.TaxID)||"",ReceiveName:(null===t||void 0===t||null===(o=t.store)||void 0===o?void 0:o.Owner)||"",ReceiveContact:(null===t||void 0===t||null===(r=t.store)||void 0===r?void 0:r.TEL_NO)||"",ReceiveAddress:(null===t||void 0===t||null===(a=t.store)||void 0===a?void 0:a.ShippingAddress)||"",InvoiceName:(null===t||void 0===t||null===(i=t.store)||void 0===i?void 0:i.Contact)||"",InvoiceContact:(null===t||void 0===t||null===(s=t.store)||void 0===s?void 0:s.TEL_NO)||"",InvoiceAddress:(null===t||void 0===t||null===(l=t.store)||void 0===l?void 0:l.InvoiceAddress)||"",Guid:t.Guid,productData:Object(u["a"])(t.productData),store:Object(n["a"])({},t.store)},d.$store.commit("BRANCHSTORE",c)},InventoryShortItem:function(t,e,o){var r,a,i,s,l,d,c,m=this;this.print("庫存不足表單傳出來的值",t),t.productData=[],t.productData[0]=Object(n["a"])({IsPartialDelivery:e,PartialDeliveryQuantity:Number(t.PartialDeliveryQuantity),IsPending:t.IsPending,orderQuantity:t.orderQuantity,warehousesNum:t.warehousesNum,StoreGuid:t.Guid},m.exceptProduct),e?(m.detailRows.some((function(e,o){if(e.Guid===t.Guid&&e.IsPending)return m.delItem(o+1),!0})),m.detailRows.some((function(e,o){if(e.Guid===t.Guid)return m.detailRows.splice(o+1,0,t),!0})),m.detailRows.some((function(e){if(e.Guid===t.Guid){var r="訂購"===o?"orderQuantity":"warehousesNum";return e[r]=m.currentValue-t[r],e.warehousesNum=0,!0}}))):(m.detailRows.some((function(e,o){if(e.Guid===t.Guid&&e.IsPending)return m.delItem(o),!0})),m.detailRows.forEach((function(e){e.Guid!==t.Guid||e.IsPending||(e.IsPending=!0,e.orderQuantity=t.orderQuantity,e.warehousesNum=0)}))),m.$emit("addNewDetailRows",m.detailRows,"Order",m.product.OrderTemplateId);var p={TaxId:(null===t||void 0===t||null===(r=t.store)||void 0===r?void 0:r.TaxID)||"",ReceiveName:(null===t||void 0===t||null===(a=t.store)||void 0===a?void 0:a.Owner)||"",ReceiveContact:(null===t||void 0===t||null===(i=t.store)||void 0===i?void 0:i.TEL_NO)||"",ReceiveAddress:(null===t||void 0===t||null===(s=t.store)||void 0===s?void 0:s.ShippingAddress)||"",InvoiceName:(null===t||void 0===t||null===(l=t.store)||void 0===l?void 0:l.Contact)||"",InvoiceContact:(null===t||void 0===t||null===(d=t.store)||void 0===d?void 0:d.TEL_NO)||"",InvoiceAddress:(null===t||void 0===t||null===(c=t.store)||void 0===c?void 0:c.InvoiceAddress)||"",Guid:t.Guid,productData:Object(u["a"])(t.productData),store:t.store};e?m.$store.commit("BRANCHSTORE",p):m.$store.commit("ENTIREBRANCHSTORE",p),m.detailRows.some((function(e){if(e.Guid===t.Guid&&e.productData[0].ProductGuid===t.productData[0].ProductGuid)return m.$store.commit("CHANGEBRANCHQUANTITY",e),!0}))},returnMax:function(t){var e=this,o=e.product.InvQty;e.detailRows.forEach((function(e){e.Guid!==t&&(o-=e.orderQuantity)})),e.detailRows.some((function(e){if(e.Guid===t)return e.orderQuantity=o,!0}))},getBranch:function(){var t=this;t.allBranch=m.Data,t.allBranch.forEach((function(t){t.customName="".concat(t.CustomerShtName," / ").concat(t.CustomerID)}))}},watch:{allQuantity:function(){var t=this;t.$emit("exportAllQuantity")},product:function(t){var e=this;e.exceptProduct={ClassCode:t.ClassCode,ClassName:t.ClassName,ProductGuid:t.ProductGuid,InvQty:t.InvQty,InvTotal:t.InvTotal,IsOrder:t.IsOrder,IsPR:t.IsPR,ItemName:t.ItemName,ItemNo:t.ItemNo,Specification:t.Specification,UOM:t.UOM,UnitPrice:t.UnitPrice,WhseID:t.WhseID}}},computed:{allQuantity:function(){var t=this;return t.detailRows.map((function(t){return Number(t.orderQuantity)}))},selectedStore:function(){var t=this;return t.detailRows.map((function(t){if(t.store)return t.store.CustomerID}))},filterStore:function(){var t=this;return 0!==t.selectedStore.length&&t.selectedStore||(t.filterStore=t.allBranch),t.allBranch.filter((function(e){return-1===t.selectedStore.indexOf(e.CustomerID)}))},saleInfo:function(){return JSON.parse(localStorage.getItem("saleInfo"))}},mounted:function(){var t=this;t.product=t.orderProduct,t.detailRows=Object(u["a"])(t.product.DetailRows),t.getBranch()},components:{InventoryShortageModal:l["a"]},destroyed:function(){$(".modal").modal("hide"),$("body").removeClass("modal-open"),$(".modal-backdrop").remove()}},v=p,f=(o("6815"),o("2877")),h=Object(f["a"])(v,i,s,!1,null,"a377f938",null),y=h.exports,w=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"office-block"},[o("div",{staticClass:"store-title"},[o("span",[t._v(" "+t._s(t.product.ItemNo)+"-"+t._s(t.product.ItemName)+" (庫存量:"+t._s(t.product.InvQty)+") ")])]),o("span",{staticClass:"templateDel",on:{click:function(e){return t.delProduct(t.product.PRTemplateId)}}},[o("i",{staticClass:"far fa-trash-alt"})]),t._m(0),t._l(t.detailRows,(function(e,r){return o("div",{key:r,staticClass:"store-list"},[o("div",{staticClass:"store bg-white"},[o("span",{directives:[{name:"show",rawName:"v-show",value:e.IsPending,expression:"PRItem.IsPending"}],staticClass:"pendingOrder"},[t._v(" 掛單 ")]),o("span",{staticClass:"pl-3 text-center font-weight-bold"},[t._v(t._s(r+1)+".")]),o("VSelect",{staticClass:"col-6",attrs:{getOptionLabel:function(t){return t.customName},placeholder:"請選擇",valueFormat:"object",options:t.filterStore,disabled:e.IsPending&&e.store&&t.product.InvQty>0},on:{input:function(o){return t.changeStore(e)}},model:{value:e.store,callback:function(o){t.$set(e,"store",o)},expression:"PRItem.store"}},[o("span",{attrs:{slot:"no-options"},slot:"no-options"},[t._v("暫無資料")])]),o("input",{directives:[{name:"model",rawName:"v-model.number",value:e.orderQuantity,expression:"PRItem.orderQuantity",modifiers:{number:!0}}],staticClass:"amount col-2",attrs:{type:"number",placeholder:"請輸入數量",disabled:!e.store||e.IsPending&&t.product.InvQty>0},domProps:{value:e.orderQuantity},on:{keyup:function(o){return t.checkQuantity(e,"訂購")},change:function(o){return t.checkQuantity(e,"訂購")},input:function(o){o.target.composing||t.$set(e,"orderQuantity",t._n(o.target.value))},blur:function(e){return t.$forceUpdate()}}}),o("input",{directives:[{name:"model",rawName:"v-model.number",value:e.warehousesNum,expression:"PRItem.warehousesNum",modifiers:{number:!0}}],staticClass:"amount col-2",attrs:{type:"number",placeholder:"請輸入數量",disabled:!e.store||e.IsPending},domProps:{value:e.warehousesNum},on:{keyup:function(o){return t.checkQuantity(e,"寄倉")},change:function(o){return t.checkQuantity(e,"寄倉")},input:function(o){o.target.composing||t.$set(e,"warehousesNum",t._n(o.target.value))},blur:function(e){return t.$forceUpdate()}}}),o("div",{staticClass:"col-2 px-0"},[o("button",{staticClass:"btn btn_primary",attrs:{type:"button"},on:{click:function(e){return t.addNewItem(t.detailRows.length+1)}}},[t._v(" 新增 ")]),o("button",{staticClass:"btn btn_danger",attrs:{type:"button"},on:{click:function(o){return t.delItem(r,e)}}},[t._v(" 移除 ")])])],1)])})),o("InventoryShortageModal",{ref:t.prGuid,attrs:{Guid:t.prGuid,Store:t.prStore,InvQty:t.product.InvQty,inputType:t.inputType,screenTotal:t.nowTotal,currentValue:t.currentValue,totalMinusScreen:t.totalMinusNow},on:{confirmQuantity:t.InventoryShortItem,returnMax:t.returnMax}})],2)},I=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"store-list"},[o("div",{staticClass:"row"},[o("span",{staticClass:"px-0 col-6 pl-5 text-muted small mr-3"},[t._v(" * 請先選擇分店再輸入數量 ")]),o("span",{staticClass:"pl-0 ml-0 col-2 text-center font-weight-bold"},[t._v(" 訂購數量 ")]),o("span",{staticClass:"pl-0 col-2 text-center font-weight-bold"},[t._v("寄倉數量")]),o("span",{staticClass:"col-2"})])])}],R={name:"PRTemplate",mixins:[d["a"],c["a"]],props:{PRProduct:Object},data:function(){return{detailRows:[],allBranch:[],inputType:"訂購",product:{},prGuid:"",prStore:{},exceptProduct:{},nowTotal:0,totalMinusNow:0,currentValue:0}},methods:{addNewItem:function(){var t=this;t.detailRows.push({Guid:t.Guid(),IsPending:!1,store:null,orderQuantity:1,warehousesNum:0,IsPartialDelivery:!1,PartialDeliveryQuantity:0,productData:[Object(n["a"])({IsPending:!1,StoreGuid:null},t.exceptProduct)]}),t.$emit("addNewDetailRows",t.detailRows,"PR",t.product.PRTemplateId)},delItem:function(t,e){var o=this;o.detailRows.some((function(e,r){if(t===r)return o.$store.commit("DELBRANCHSTORE",e),!0})),"OrderSearch"===localStorage.getItem("routerFrom")&&o.$emit("removeRowsDetail",e),o.detailRows.splice(t,1),o.$nextTick((function(){0===o.detailRows.length&&setTimeout((function(){o.$emit("removeTemplate",o.product.PRTemplateId,"prRows",!0)}),50)}))},delProduct:function(t){var e=this;e.detailRows.forEach((function(t){e.$store.commit("DELBRANCHSTORE",t)})),e.$nextTick((function(){setTimeout((function(){e.$emit("removeTemplate",t,"prRows",!0)}),50)}))},checkQuantity:function(t,e){var o=this;if("寄倉"===e&&t.warehousesNum>t.orderQuantity)return o.$notify({title:"提示",message:"寄倉數量不得大於訂購數量",type:"warning",duration:5e3}),void o.$nextTick((function(){t.warehousesNum=t.orderQuantity}));o.currentValue=Number(t.orderQuantity),t.productData=[],t.productData[0]=Object(n["a"])({IsPartialDelivery:!1,PartialDeliveryQuantity:0,IsPending:t.IsPending,orderQuantity:t.orderQuantity,warehousesNum:t.warehousesNum,StoreGuid:t.Guid},o.exceptProduct),o.$store.commit("CHANGEBRANCHQUANTITY",t),o.nowTotal=0,o.detailRows.forEach((function(t){t.IsPending||(o.nowTotal+=Number(t.orderQuantity))})),o.totalMinusNow=o.product.InvQty-o.nowTotal,o.nowTotal>o.product.InvQty&&o.totalMinusNow<0&&(o.inputType=e,o.prGuid=t.Guid,o.prStore=t.store,o.$nextTick((function(){var e=o.$refs[t.Guid].$el;$(e).modal("show")})))},changeStore:function(t){var e,o,r,a=this,i={};t.productData=[],t.productData[0]=Object(n["a"])({IsPartialDelivery:!1,PartialDeliveryQuantity:0,IsPending:t.IsPending,orderQuantity:t.orderQuantity,warehousesNum:t.warehousesNum,StoreGuid:t.Guid},a.exceptProduct),i={TaxId:t.store.TaxID,ReceiveName:t.store.Owner,ReceiveContact:t.store.TEL_NO,ReceiveAddress:t.store.ShippingAddress,InvoiceName:(null===t||void 0===t||null===(e=t.store)||void 0===e?void 0:e.Contact)||"",InvoiceContact:(null===t||void 0===t||null===(o=t.store)||void 0===o?void 0:o.TEL_NO)||"",InvoiceAddress:(null===t||void 0===t||null===(r=t.store)||void 0===r?void 0:r.InvoiceAddress)||"",Guid:t.Guid,productData:Object(u["a"])(t.productData),store:Object(n["a"])({},t.store)},a.$store.commit("BRANCHSTORE",i)},InventoryShortItem:function(t,e,o){var r,a,i,s=this;t.productData=[],t.productData[0]=Object(n["a"])({IsPartialDelivery:e,PartialDeliveryQuantity:Number(t.PartialDeliveryQuantity),IsPending:t.IsPending,orderQuantity:t.orderQuantity,warehousesNum:t.warehousesNum,StoreGuid:t.Guid},s.exceptProduct),e?(s.detailRows.some((function(e,o){if(e.Guid===t.Guid&&e.IsPending)return s.delItem(o),!0})),s.detailRows.some((function(e,o){if(e.Guid===t.Guid)return s.detailRows.splice(o+1,0,t),!0})),s.detailRows.some((function(e){if(e.Guid===t.Guid){var r="訂購"===o?"orderQuantity":"warehousesNum";return e[r]=s.currentValue-t[r],e.warehousesNum=0,!0}}))):(s.detailRows.some((function(e,o){if(e.Guid===t.Guid&&e.IsPending)return s.delItem(o),!0})),s.detailRows.some((function(e){if(e.Guid===t.Guid&&!e.IsPending)return e.IsPending=!0,e.orderQuantity=t.orderQuantity,e.warehousesNum=0,!0}))),s.$emit("addNewDetailRows",s.detailRows,"PR",s.product.PRTemplateId);var l={TaxId:t.store.TaxID,ReceiveName:t.store.Owner,ReceiveContact:t.store.TEL_NO,ReceiveAddress:t.store.ShippingAddress,InvoiceName:(null===t||void 0===t||null===(r=t.store)||void 0===r?void 0:r.Contact)||"",InvoiceContact:(null===t||void 0===t||null===(a=t.store)||void 0===a?void 0:a.TEL_NO)||"",InvoiceAddress:(null===t||void 0===t||null===(i=t.store)||void 0===i?void 0:i.InvoiceAddress)||"",Guid:t.Guid,productData:Object(u["a"])(t.productData),store:t.store};e?s.$store.commit("BRANCHSTORE",l):s.$store.commit("ENTIREBRANCHSTORE",l),s.detailRows.some((function(e){if(e.Guid===t.Guid&&e.productData[0].ProductGuid===t.productData[0].ProductGuid)return s.$store.commit("CHANGEBRANCHQUANTITY",e),!0}))},returnMax:function(t){var e=this,o=e.product.InvQty;e.detailRows.forEach((function(e){e.Guid!==t&&(o-=e.orderQuantity)})),e.detailRows.some((function(e){if(e.Guid===t)return e.orderQuantity=o,!0}))},getBranch:function(){var t=this;t.allBranch=m.Data,t.allBranch.forEach((function(t){t.customName="".concat(t.CustomerShtName," / ").concat(t.CustomerID)}))}},watch:{allQuantity:function(){var t=this;t.$emit("exportAllQuantity")},product:function(t){var e=this;e.exceptProduct={ClassCode:t.ClassCode,ClassName:t.ClassName,ProductGuid:t.ProductGuid,InvQty:t.InvQty,InvTotal:t.InvTotal,IsOrder:t.IsOrder,IsPR:t.IsPR,ItemName:t.ItemName,ItemNo:t.ItemNo,Specification:t.Specification,UOM:t.UOM,UnitPrice:t.UnitPrice,WhseID:t.WhseID}}},computed:{allQuantity:function(){var t=this;return t.detailRows.map((function(t){return Number(t.orderQuantity)}))},selectedStore:function(){var t=this;return t.detailRows.map((function(t){if(t.store)return t.store.CustomerID}))},filterStore:function(){var t=this;return 0!==t.selectedStore.length&&t.selectedStore||(t.filterStore=t.allBranch),t.allBranch.filter((function(e){return-1===t.selectedStore.indexOf(e.CustomerID)}))},saleInfo:function(){return JSON.parse(localStorage.getItem("saleInfo"))}},mounted:function(){var t=this;t.product=t.PRProduct,t.detailRows=Object(u["a"])(t.product.DetailRows),t.getBranch()},components:{InventoryShortageModal:l["a"]},destroyed:function(){$(".modal").modal("hide"),$("body").removeClass("modal-open"),$(".modal-backdrop").remove()}},N=R,C=(o("2ca6"),Object(f["a"])(N,w,I,!1,null,"764f423c",null)),g=C.exports,P=o("2530"),D=o("2725"),T=o("a9de"),Q=o("2f62"),b=o("d072"),O=o("5f2c"),S={name:"AllMainStoreOrder",mixins:[d["a"],T["a"],c["a"]],data:function(){return{rows:[],tempRows:[],orderRows:[],prRows:[],totalOrderQuantity:0,totalPRQuantity:0,allDeliveryTime:[],allCharge:{Sales_Fees:{Costs:30}},allFreight:{Sales_Fees:{Costs:30}},allDeliveryDate:{},keyData:0}},methods:{openModal:function(t){var e=this;e.item=Object(n["a"])({},t)},openCheck:function(){var t=this,e=!1,o=!1;return 0===t.rows.length&&0===t.tempRows.length?(t.$notify({title:"提示",message:"購物車尚無商品，請先行選擇",type:"warning",duration:3500}),!1):(t.rows.forEach((function(o){if(o.DetailRows.some((function(o){if(!o.store)return t.$notify({title:"提示",message:"尚有未選擇分店的商品，請先行選擇",type:"warning",duration:3500}),e=!0,!0})),e)return!0})),!e&&(t.tempRows.forEach((function(e){if(e.DetailRows.some((function(e){if(!e.store)return t.$notify({title:"提示",message:"尚有未選擇分店的商品，請先行選擇",type:"warning",duration:3500}),o=!0,!0})),o)return!0})),!o&&void $("#check").modal("show")))},sendData:function(t){var e=this;this.print("tmepCheck",t),t.some((function(o){if(o.IsOrder&&o.IsPR)return e.splitRow(t),!0})),t.length>0&&(e.tempRows=JSON.parse(JSON.stringify(t))),$("#placeordermodal").modal("hide")},removeTemplate:function(t,e,o){var r=this;r[e].splice(t,1),r[e].forEach((function(t,o){"orderRows"===e&&(t.OrderTemplateId=o),"prRows"===e&&(t.PRTemplateId=o)})),r.rows=r.orderRows.concat(r.prRows),o&&r.$store.commit("SUREPRODUCT",r.rows),this.keyData+=1},removeRowsDetail:function(t){var e=this;e.rows.forEach((function(e){e.DetailRows.some((function(o,r){if(o.Guid===t.Guid)return e.DetailRows.splice(r,1),!0}))}))},addNewDetailRows:function(t,e,o){this.print("addNewDetailRows",t);var r=this;"Order"===e&&r.orderRows.forEach((function(e){e.OrderTemplateId===o&&(e.DetailRows=t)})),"PR"===e&&r.prRows.forEach((function(e){e.PRTemplateId===o&&(e.DetailRows=t)}))},getAllOrderTemplateQuantity:function(){var t=this,e=[];t.totalOrderQuantity=0,t.orderRows.forEach((function(t){t.DetailRows.forEach((function(o){t.totalQuantityInfo={totalQuantity:Number(o.orderQuantity),templateId:t.OrderTemplateId},e.push(t.totalQuantityInfo)}))})),e.forEach((function(e){t.totalOrderQuantity+=e.totalQuantity}))},getAllPRTemplateQuantity:function(){var t=this,e=[];t.totalPRQuantity=0,t.prRows.forEach((function(t){t.DetailRows.forEach((function(o){t.totalQuantityInfo={totalQuantity:Number(o.orderQuantity),templateId:t.PRTemplateId},e.push(t.totalQuantityInfo)}))})),e.forEach((function(e){t.totalPRQuantity+=e.totalQuantity}))}},mounted:function(){var t=this;t.$store.commit("HEADER","總店訂單作業"),t.$store.commit("ISWELCOME",!1),t.$store.commit("ISGOBACK",!0),t.rows=t.$route.params.confirmProduct||JSON.parse(localStorage.getItem("sureProduct")),"MainStoreOrder"===localStorage.getItem("routerFrom")?(t.splitRow(t.rows),t.filterTemplate(t.rows)):"OrderSearch"===localStorage.getItem("routerFrom")&&t.OrderSearchFilter(t.rows),t.allDeliveryTime=b.Data,t.allDeliveryDate=O.Data},watch:{tempRows:function(t){var e=this;e.filterTemplate(t)},prRows:function(t){var e=this;0===t.length&&(e.totalPRQuantity=0)},orderRows:function(t){var e=this;0===t.length&&(e.totalOrderQuantity=0)}},computed:Object(n["a"])({saleInfo:function(){return JSON.parse(localStorage.getItem("saleInfo"))},customerData:function(){return JSON.parse(localStorage.getItem("customer"))}},Object(Q["b"])({localSureProduct:"confirmProduct"})),components:{OrderTemplate:y,PRTemplate:g,Order:P["a"],CheckOrder:D["a"]},destroyed:function(){$(".modal").modal("hide"),$("body").removeClass("modal-open"),$(".modal-backdrop").remove()}},_=S,G=(o("f4e6"),Object(f["a"])(_,r,a,!1,null,"65b70918",null));e["default"]=G.exports},f4e6:function(t,e,o){"use strict";o("aca8")},fdec:function(t,e,o){}}]);